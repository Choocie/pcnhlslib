#include "dut.h"

array<exponential_t, static_pow2(LUT_SIZE)> expLUT = { 0.998046875, 0.978515625, 0.958984375, 0.939453125, 0.921875, 0.904296875, 0.88671875, 0.869140625, 0.853515625, 0.8359375, 0.8203125, 0.8046875, 0.7890625, 0.7734375, 0.7578125, 0.744140625, 0.728515625, 0.71484375, 0.701171875, 0.6875, 0.673828125, 0.662109375, 0.6484375, 0.63671875, 0.623046875, 0.611328125, 0.599609375, 0.587890625, 0.576171875, 0.56640625, 0.5546875, 0.54296875, 0.533203125, 0.5234375, 0.513671875, 0.501953125, 0.4921875, 0.484375, 0.474609375, 0.46484375, 0.455078125, 0.447265625, 0.4375, 0.4296875, 0.421875, 0.4140625, 0.40625, 0.3984375, 0.390625, 0.3828125, 0.375, 0.3671875, 0.361328125, 0.353515625, 0.345703125, 0.33984375, 0.333984375, 0.326171875, 0.3203125, 0.314453125, 0.30859375, 0.302734375, 0.296875, 0.291015625, 0.28515625, 0.279296875, 0.2734375, 0.26953125, 0.263671875, 0.2578125, 0.25390625, 0.248046875, 0.244140625, 0.23828125, 0.234375, 0.23046875, 0.224609375, 0.220703125, 0.216796875, 0.212890625, 0.208984375, 0.205078125, 0.201171875, 0.197265625, 0.193359375, 0.189453125, 0.185546875, 0.181640625, 0.177734375, 0.173828125, 0.171875, 0.16796875, 0.1640625, 0.162109375, 0.158203125, 0.154296875, 0.15234375, 0.1484375, 0.146484375, 0.142578125, 0.140625, 0.138671875, 0.134765625, 0.1328125, 0.130859375, 0.126953125, 0.125, 0.123046875, 0.119140625, 0.1171875, 0.115234375, 0.11328125, 0.111328125, 0.109375, 0.107421875, 0.10546875, 0.103515625, 0.099609375, 0.09765625, 0.09765625, 0.095703125, 0.09375, 0.091796875, 0.08984375, 0.087890625, 0.0859375, 0.083984375, 0.08203125, 0.080078125, 0.080078125, 0.078125, 0.076171875, 0.07421875, 0.07421875, 0.072265625, 0.0703125, 0.068359375, 0.068359375, 0.06640625, 0.064453125, 0.064453125, 0.0625, 0.060546875, 0.060546875, 0.05859375, 0.05859375, 0.056640625, 0.0546875, 0.0546875, 0.052734375, 0.052734375, 0.05078125, 0.05078125, 0.048828125, 0.048828125, 0.046875, 0.046875, 0.044921875, 0.044921875, 0.04296875, 0.04296875, 0.04296875, 0.041015625, 0.041015625, 0.0390625, 0.0390625, 0.037109375, 0.037109375, 0.037109375, 0.03515625, 0.03515625, 0.03515625, 0.033203125, 0.033203125, 0.033203125, 0.03125, 0.03125, 0.03125, 0.029296875, 0.029296875, 0.029296875, 0.02734375, 0.02734375, 0.02734375, 0.02734375, 0.025390625, 0.025390625, 0.025390625, 0.0234375, 0.0234375, 0.0234375, 0.0234375, 0.0234375, 0.021484375, 0.021484375, 0.021484375, 0.021484375, 0.01953125, 0.01953125, 0.01953125, 0.01953125, 0.01953125, 0.017578125, 0.017578125, 0.017578125, 0.017578125, 0.017578125, 0.015625, 0.015625, 0.015625, 0.015625, 0.015625, 0.015625, 0.013671875, 0.013671875, 0.013671875, 0.013671875, 0.013671875, 0.013671875, 0.013671875, 0.01171875, 0.01171875, 0.01171875, 0.01171875, 0.01171875, 0.01171875, 0.01171875, 0.01171875, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.009765625, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.0078125, 0.005859375, 0.005859375, 0.005859375, 0.005859375, 0.005859375, 0.005859375, 0.0};

void dut(hls::stream<array<coordinate_t,F_C>>       coordinateStream[PAR],
         hls::stream<array<feature_t,F_P>>          featureStream[PAR],
	     hls::stream<array<input_t,F_IN>>           inputStream[PAR],
         hls::stream<array<output_t,F_IN+2*F_P>>    outputStream[PAR],
         hls::stream<int>                           &numStream) {
    #pragma HLS dataflow
    gravnetconv<input_t,
                coordinate_t,
                feature_t,
		      distance_t,
                exponential_t,
		      accum_t,
		      output_t,
		      F_C,
		      F_P,
		      F_IN,
                K,
		      N,
		      PAR,
		      II,
                LUT_SIZE>(coordinateStream,
                          featureStream,
                          inputStream,
                          outputStream,
                          expLUT,
                          numStream);

}