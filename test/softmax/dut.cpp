#include "dut.h"

array<output_t, static_pow2(LUT_SIZE)> expLUT ={
	 1.     ,1.0625
	,1.125  ,1.1875 ,1.3125 ,1.375  ,1.4375 ,1.5625 ,1.625  ,1.75   ,1.875  ,2.
	,2.125  ,2.25   ,2.375  ,2.5625 ,2.6875 ,2.875  ,3.0625 ,3.25   ,3.5    ,3.6875
	,3.9375 ,4.1875 ,4.5    ,4.75   ,5.0625 ,5.375  ,5.75   ,6.125  ,6.5    ,6.9375
	,7.375  ,7.875  ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375
	,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,7.9375 ,0.     ,0.     ,0.     ,0.     
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.	    ,0.     ,0.     ,0.     ,0.     
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.     ,0.
	,0.     ,0.     ,0.     ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625
	,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625 ,0.0625
	,0.0625 ,0.125  ,0.125  ,0.125  ,0.125  ,0.125  ,0.125  ,0.125  ,0.125  ,0.1875
	,0.1875 ,0.1875 ,0.1875 ,0.1875 ,0.25   ,0.25   ,0.25   ,0.25   ,0.3125 ,0.3125
	,1.3125 ,0.375  ,0.375  ,0.375  ,0.4375 ,0.4375 ,0.5    ,0.5    ,0.5625 ,0.5625
	,0.625  ,0.625  ,0.6875 ,0.75   ,0.75   ,0.8125 ,0.875  ,0.9375
	};

void dut(hls::stream<array<input_t,F>> &inputStream,
         hls::stream<array<output_t,F>> &outputStream) {
    softmax<input_t,
    output_t,
    F,
    II,
    LUT_SIZE>(
  inputStream,
  outputStream,
  expLUT);
}
